<!DOCTYPE html> <html> <head> <title>PSR Files Rejections</title> <meta content="text/html;charset=utf-8" http-equiv="Content-Type"> <meta content="utf-8" http-equiv="encoding"> <style type="text/css"> *{font-family: Cali; font-size: 12px; user-select: none; -moz-user-select: none; } @font-face{font-family: Cali; src: url(./C.ttf); } span{display: inline-block; border: 1px solid black; border-collapse: collapse; } #tab{width: 75%; } table,tr,td,th{border: 1px solid #dedede; border-collapse: collapse; user-select: text; -moz-user-select: text; } .MAIN{text-align: center; } label,button{display: block; font-size: 1.6em; border: 1px solid black; width: 179px; margin-left: auto; margin-right: auto; background : -moz-linear-gradient(50% 100% 90deg,rgba(0, 0, 0, 0.4) 0%,rgba(255, 255, 255, 0.7) 100%); background : -webkit-linear-gradient(90deg, rgba(0, 0, 0, 0.4) 0%, rgba(255, 255, 255, 0.7) 100%); background : -webkit-gradient(linear,50% 100% ,50% 0% ,color-stop(0,rgba(0, 0, 0, 0.4) ),color-stop(1,rgba(255, 255, 255, 0.7) )); background : -o-linear-gradient(90deg, rgba(0, 0, 0, 0.4) 0%, rgba(255, 255, 255, 0.7) 100%); background : -ms-linear-gradient(90deg, rgba(0, 0, 0, 0.4) 0%, rgba(255, 255, 255, 0.7) 100%); /* background : -moz-linear-gradient(50% 0% -90deg,rgba(255, 0, 16, 1) 0%,rgba(251, 0, 15, 1) 16.71%,rgba(238, 0, 14, 1) 34.8%,rgba(216, 0, 11, 1) 53.53%,rgba(186, 0, 7, 1) 72.71%,rgba(147, 0, 2, 1) 92.05%,rgba(129, 0, 0, 1) 100%); background : -webkit-linear-gradient(-90deg, rgba(255, 0, 16, 1) 0%, rgba(251, 0, 15, 1) 16.71%, rgba(238, 0, 14, 1) 34.8%, rgba(216, 0, 11, 1) 53.53%, rgba(186, 0, 7, 1) 72.71%, rgba(147, 0, 2, 1) 92.05%, rgba(129, 0, 0, 1) 100%); background : -webkit-gradient(linear,50% 0% ,50% 100% ,color-stop(0,rgba(255, 0, 16, 1) ),color-stop(0.1671,rgba(251, 0, 15, 1) ),color-stop(0.348,rgba(238, 0, 14, 1) ),color-stop(0.5353,rgba(216, 0, 11, 1) ),color-stop(0.7271,rgba(186, 0, 7, 1) ),color-stop(0.9205,rgba(147, 0, 2, 1) ),color-stop(1,rgba(129, 0, 0, 1) )); background : -o-linear-gradient(-90deg, rgba(255, 0, 16, 1) 0%, rgba(251, 0, 15, 1) 16.71%, rgba(238, 0, 14, 1) 34.8%, rgba(216, 0, 11, 1) 53.53%, rgba(186, 0, 7, 1) 72.71%, rgba(147, 0, 2, 1) 92.05%, rgba(129, 0, 0, 1) 100%); background : -ms-linear-gradient(-90deg, rgba(255, 0, 16, 1) 0%, rgba(251, 0, 15, 1) 16.71%, rgba(238, 0, 14, 1) 34.8%, rgba(216, 0, 11, 1) 53.53%, rgba(186, 0, 7, 1) 72.71%, rgba(147, 0, 2, 1) 92.05%, rgba(129, 0, 0, 1) 100%); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr='#FF0010', endColorstr='#810000' ,GradientType=0)"; background : linear-gradient(180deg, rgba(255, 0, 16, 1) 0%, rgba(251, 0, 15, 1) 16.71%, rgba(238, 0, 14, 1) 34.8%, rgba(216, 0, 11, 1) 53.53%, rgba(186, 0, 7, 1) 72.71%, rgba(147, 0, 2, 1) 92.05%, rgba(129, 0, 0, 1) 100%);*/ border-radius: 4px; color: black; background-color: white; font-weight: bolder; user-select: none; } label:hover,button:hover{box-shadow: 0px 2px 1px 0.5px #e0e0e0; } label:active,button:active{background: white; } button{display: inline; width: auto; } h2{color: red; } .STYRE{width: 350px; } .STYSA{width: 10px; } .STYVE{width: 120px; } #filNa{width: 500%; display: inline-block; border: none; user-select: text; -moz-user-select: text; margin-right: auto; margin-left: auto; } </style> </head> <body> <div class="MAIN" id="main"> <label for="ifile">Select BOA PSR File</label> <input type="file" name="" id="ifile" value="File" style="visibility: hidden; width: 160px;" onchange="Rejection()"> </div> <div style="margin: 16px auto 5px auto; display: inline-block; width: 100%; background-color: white; height: auto;" > <h2 id="norej"></h2> <table id="tab" style="margin-right: auto; margin-left: auto;"> <tbody> <h3 id="filNa"></h3> <tr> <th>Status</th> <th>Vendor</th> <th>Amount</th> <th>Document</th> <th>Currency</th> <th>Payment ID</th> <th>Date</th> <th>Reason</th> </tr> </tbody> </table> </div> <div class="MAIN"> <button onclick="shRj()">Check Rejections</button> <button onclick="Ref()">Refresh</button> </div> </body> <script type="text/javascript"> var sT = []; var vE = []; var aM = []; var dO = []; var cU = []; var pA = []; var dA = []; var rE = []; var rrE = []; var Tab = document.getElementById('tab'); function shRj() {for (var Rj = 0; Rj < rE.length; Rj++) {var row = Tab.insertRow(); var ST = row.insertCell(0); var VE = row.insertCell(1); var AM = row.insertCell(2); var DO = row.insertCell(3); var CU = row.insertCell(4); var PA = row.insertCell(5); var DA = row.insertCell(6); var RE = row.insertCell(7); ST.innerHTML = sT[Rj]; VE.innerHTML = vE[Rj]; AM.innerHTML = aM[Rj]; DO.innerHTML = dO[Rj]; CU.innerHTML = cU[Rj]; PA.innerHTML += pA; DA.innerHTML += dA; RE.innerHTML = rE[Rj]; ST.setAttribute('class','STYSA'); VE.setAttribute('class','STYVE'); AM.setAttribute('class','STY'); DO.setAttribute('class','STY'); CU.setAttribute('class','STY'); PA.setAttribute('class','STY'); DA.setAttribute('class','STY'); RE.setAttribute('class','STYRE'); } document.getElementById('filNa').innerHTML = document.getElementById('ifile').value; } function Rejection() {var XMLRJC = new XMLHttpRequest(); XMLRJC.onreadystatechange = function () {if(XMLRJC.readyState == 4 && XMLRJC.status == 200){var R = XMLRJC.responseXML.getElementsByTagName('TxSts'); var PI = XMLRJC.responseXML.getElementsByTagName('OrgnlMsgId'); var DT = XMLRJC.responseXML.getElementsByTagName('CreDtTm'); for (var rrr = 0; rrr < PI.length; rrr++) {pA.push(PI[rrr].childNodes[0].nodeValue); dA.push(DT[rrr].childNodes[0].nodeValue); } for (var r = 0; r < R.length; r++) {if (R[r].childNodes[0].nodeValue === 'RJCT') {sT.push(R[r].childNodes[0].nodeValue); dO.push(R[r].parentNode.childNodes[1].innerHTML); aM.push(R[r].parentNode.getElementsByTagName('InstdAmt')[0].innerHTML); cU.push(R[r].parentNode.getElementsByTagName('InstdAmt')[0].getAttributeNode('Ccy').nodeValue); vE.push(R[r].parentNode.getElementsByTagName('Cdtr')[0].firstChild.nextSibling.firstChild.nodeValue); if (R[r].parentNode.getElementsByTagName('StsRsnInf')[0].getElementsByTagName('AddtlInf').length == "1") {rE.push(R[r].parentNode.getElementsByTagName('StsRsnInf')[0].firstChild.nextSibling.nextSibling.firstChild.nodeValue); }else{rE.push(R[r].parentNode.getElementsByTagName('StsRsnInf')[0].firstChild.nextSibling.nextElementSibling.innerHTML); (R[r].parentNode.getElementsByTagName('StsRsnInf')[0].firstChild.nextSibling.nextElementSibling.nextElementSibling.innerHTML); (R[r].parentNode.getElementsByTagName('StsRsnInf')[0].firstChild.nextSibling.nextElementSibling.nextElementSibling.nextElementSibling.innerHTML); (R[r].parentNode.getElementsByTagName('StsRsnInf')[0].firstChild.nextSibling.nextElementSibling.nextElementSibling.nextElementSibling.nextElementSibling.innerHTML); } } } } }; XMLRJC.open("GET",document.getElementById('ifile').files[0].name,true); XMLRJC.send(); xmlDoc = XMLRJC.response; } function Ref() {window.location.reload(); } </script> </html>